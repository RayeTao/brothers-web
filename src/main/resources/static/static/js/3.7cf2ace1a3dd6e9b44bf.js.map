{"version":3,"sources":["webpack:///src/views/media/UploadMedia.vue","webpack:///./src/views/media/UploadMedia.vue?a45e","webpack:///./src/views/media/UploadMedia.vue"],"names":["UploadMedia","data","options","value","label","children","selectedOptions","dialogImageUrl","dialogVisible","fileList","selectedType","files","uploadPercentage","showPercentage","methods","getOptions","this","length","console","log","removeImg","file","previewImg","url","addImgList","slice","uploadMedia","_this","_loop","i","formData","FormData","append","raw","vm","axios_default","a","post","Content-Type","then","response","success","$message","message","type","catch","error","resetMedia","uploadLimit","media_UploadMedia","render","_vm","_h","$createElement","_c","_self","staticStyle","margin-top","text-align","_v","width","attrs","on","change","model","callback","$$v","expression","action","list-type","auto-upload","file-list","on-change","limit","on-exceed","http-request","on-preview","on-remove","staticClass","visible","update:visible","$event","src","alt","size","nativeOn","click","directives","name","rawName","margin","text-inside","stroke-width","percentage","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/3.7cf2ace1a3dd6e9b44bf.js","sourcesContent":["<template>\n<div>\n  <div style=\"margin-top: 100px;text-align: center\">\n    <span>上传类别:</span>\n    <el-cascader\n      :options=\"options\"\n      v-model=\"selectedOptions\"\n      @change=\"getOptions\"\n    style=\"width: 300px\">\n    </el-cascader>\n  </div>\n  <div style=\"margin-top: 50px\">\n    <el-upload\n      action=\"http://localhost:8081\"\n      list-type=\"picture-card\"\n      :auto-upload=\"false\"\n      :file-list=\"fileList\"\n      :on-change=\"addImgList\"\n      :limit='3'\n      :on-exceed='uploadLimit'\n      :http-request='uploadMedia'\n      :on-preview=\"previewImg\"\n      :on-remove=\"removeImg\">\n     <i class=\"el-icon-plus\"></i>\n    </el-upload>\n    <el-dialog :visible.sync=\"dialogVisible\">\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\n    </el-dialog>\n    <div style=\"margin-top: 50px\">\n      <el-button size=\"small\" type=\"primary\"  @click.native=\"uploadMedia\">上传</el-button>\n      <el-button size=\"small\" type=\"primary\"  @click.native=\"resetMedia\">继续上传</el-button>\n    </div>\n\n    <div style=\"margin:20px auto; width: 400px\" v-show=\"this.showPercentage\">\n      <el-progress :text-inside=\"true\" :stroke-width=\"18\" :percentage=\"this.uploadPercentage\"></el-progress>\n    </div>\n\n  </div>\n</div>\n</template>\n\n<script>\n  import axios from 'axios'\n    export default {\n      data() {\n        return {\n          options: [{\n            value: '1',\n            label: '合照',\n            children:[{\n              value:'1-1',\n              label:'小合照'\n            },\n              {\n                value:'1-2',\n                label:'大合照'\n              }]\n          }, {\n            value: '2',\n            label: '个人照',\n            children:[{\n              value:'2-1',\n              label:'李贤民'\n            },\n              {\n                value:'2-2',\n                label:'喻志立'\n              },\n              {\n                value:'2-3',\n                label:'郭会成'\n              },\n              {\n                value:'2-4',\n                label:'陶然'\n              },\n              {\n                value:'2-5',\n                label:'易朝军'\n              },\n              {\n                value:'2-6',\n                label:'张杨'\n              },\n              {\n                value:'2-7',\n                label:'马山川'\n              },\n              {\n                value:'2-8',\n                label:'秦丰伟'\n              },\n              {\n                value:'2-9',\n                label:'刘玺'\n              },\n              {\n                value:'2-10',\n                label:'关磊'\n              }\n            ]\n          }],\n          selectedOptions:[],\n          dialogImageUrl: '',\n          dialogVisible: false,\n          fileList:[],\n          selectedType:'',\n          files:[],\n          uploadPercentage:0,\n          showPercentage:false\n        }\n      },\n      methods:{\n        getOptions(){\n          this.selectedType = this.selectedOptions[this.selectedOptions.length -1]\n          console.log(this.selectedType)\n        },\n        removeImg(file, fileList) {\n          console.log(file, fileList);\n        },\n        previewImg(file) {\n          console.log(file)\n          this.dialogImageUrl = file.url;\n          this.dialogVisible = true;\n        },\n        addImgList(file, fileList){\n          this.fileList = fileList.slice(-3);\n        },\n        uploadMedia(){\n          if(!this.selectedOptions){\n            this.$message({\n              message:'请先选择上传类别',\n              type:'warning'\n            })\n            return\n          }\n          if(this.fileList.length ==0){\n            this.$message({\n              message:'请先添加照片',\n              type:'warning'\n            })\n            return\n          }\n          this.showPercentage = true\n          for(let i=0;i<this.fileList.length;i++){\n            let formData = new FormData;\n            formData.append('file', this.fileList[i].raw);\n            formData.append('type',this.selectedType)\n            let config = {\n              'Content-Type': 'multipart/form-data'\n            }\n            let vm = this;\n            axios.post('/media/upload',formData, config)\n              .then(function(response) {\n                if (response.data.success) {\n                  vm.uploadPercentage =(i+1)*100/vm.fileList.length\n                  console.log(vm.uploadPercentage )\n                  if(i == vm.fileList.length-1){\n                    vm.$message({\n                      message: response.data.message,\n                      type: 'success'\n                    });\n                  }\n                }else{\n                  vm.$message({\n                    message: response.data.message,\n                    type: 'error'\n                  });\n                }\n              })\n              .catch(function(error) {\n                console.log(error);\n              })\n          }\n\n\n        },\n        resetMedia(){\n          this.uploadPercentage = 0;\n        this.fileList=[]\n        this.showPercentage = false\n        },\n        uploadLimit(){\n          this.$message({\n            type: 'error',\n            message: '上传文件个数超出限制!最多上传3张图片!'\n          });\n        }\n      }\n    }\n\n</script>\n\n<style scoped>\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/media/UploadMedia.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticStyle:{\"margin-top\":\"100px\",\"text-align\":\"center\"}},[_c('span',[_vm._v(\"上传类别:\")]),_vm._v(\" \"),_c('el-cascader',{staticStyle:{\"width\":\"300px\"},attrs:{\"options\":_vm.options},on:{\"change\":_vm.getOptions},model:{value:(_vm.selectedOptions),callback:function ($$v) {_vm.selectedOptions=$$v},expression:\"selectedOptions\"}})],1),_vm._v(\" \"),_c('div',{staticStyle:{\"margin-top\":\"50px\"}},[_c('el-upload',{attrs:{\"action\":\"http://localhost:8081\",\"list-type\":\"picture-card\",\"auto-upload\":false,\"file-list\":_vm.fileList,\"on-change\":_vm.addImgList,\"limit\":3,\"on-exceed\":_vm.uploadLimit,\"http-request\":_vm.uploadMedia,\"on-preview\":_vm.previewImg,\"on-remove\":_vm.removeImg}},[_c('i',{staticClass:\"el-icon-plus\"})]),_vm._v(\" \"),_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisible},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.dialogImageUrl,\"alt\":\"\"}})]),_vm._v(\" \"),_c('div',{staticStyle:{\"margin-top\":\"50px\"}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},nativeOn:{\"click\":function($event){return _vm.uploadMedia($event)}}},[_vm._v(\"上传\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},nativeOn:{\"click\":function($event){return _vm.resetMedia($event)}}},[_vm._v(\"继续上传\")])],1),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(this.showPercentage),expression:\"this.showPercentage\"}],staticStyle:{\"margin\":\"20px auto\",\"width\":\"400px\"}},[_c('el-progress',{attrs:{\"text-inside\":true,\"stroke-width\":18,\"percentage\":this.uploadPercentage}})],1)],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4568806e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/media/UploadMedia.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4568806e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./UploadMedia.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./UploadMedia.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./UploadMedia.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4568806e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./UploadMedia.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4568806e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/media/UploadMedia.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}